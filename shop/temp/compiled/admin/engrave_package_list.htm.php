<!-- $Id: package_list.htm 17126 2010-04-23 10:30:26Z liuhui $ --><?php if ($this->_var['full_page']): ?><?php echo $this->fetch('engrave_pageheader.htm'); ?><?php echo $this->smarty_insert_scripts(array('files'=>'../js/utils.js,listtable.js')); ?><?php echo $this->smarty_insert_scripts(array('files'=>'../js/jquery-1.8.0.min.js')); ?><?php echo $this->smarty_insert_scripts(array('files'=>'../js/uploadify/jquery.uploadify.min.js')); ?><form method="post" action="" name="listForm" onsubmit="return confirmSubmit(this)">  <!-- start package list -->  <div class="list-div" id="listDiv"><?php endif; ?><table cellpadding="3" cellspacing="1">  <tr>    <th style="width:60px;">      <input onclick='listTable.selectAll(this, "checkboxes")' type="checkbox" />      <a href="javascript:listTable.sort('pck_id'); "><?php echo $this->_var['lang']['pck_id']; ?></a><?php echo $this->_var['sort_pck_id']; ?>    </th>    <th><?php echo $this->_var['lang']['pck_packagenumber']; ?></th>    <th><?php echo $this->_var['lang']['pck_username']; ?></th>    <th><?php echo $this->_var['lang']['pck_storagecode']; ?></th>    <th><?php echo $this->_var['lang']['pck_remark']; ?></th>    <th><?php echo $this->_var['lang']['pck_intime']; ?></th>    <th><?php echo $this->_var['lang']['pck_inventorylocation']; ?></th>    <th><?php echo $this->_var['lang']['pck_service']; ?></th>	<th><a><?php echo $this->_var['lang']['pck_packagestatus']; ?></th>    <th style="width:140px;"><?php echo $this->_var['lang']['handler']; ?></th>  <tr>  <?php $_from = $this->_var['package_list']; if (!is_array($_from) && !is_object($_from)) { settype($_from, 'array'); }; $this->push_vars('', 'package');if (count($_from)):
    foreach ($_from AS $this->_var['package']):
?>  <tr>    <td><input type="checkbox" name="checkboxes[]" value="<?php echo $this->_var['package']['pck_id']; ?>" /><?php echo $this->_var['package']['pck_id']; ?></td>    <td align="center"><?php echo $this->_var['package']['pck_expressnumber']; ?></td>    <td align="center"><?php echo $this->_var['package']['pck_username']; ?></td>    <td align="center"><?php echo $this->_var['package']['pck_storagecode']; ?></td>    <td align="center"><?php echo $this->_var['package']['pck_userremark']; ?></td>    <td align="center"><?php echo $this->_var['package']['pck_intime']; ?></td>    <td align="center"><?php echo $this->_var['package']['pck_inventorylocation']; ?></td>    <td align="center">    	<?php $_from = $this->_var['package']['pck_service_list']; if (!is_array($_from) && !is_object($_from)) { settype($_from, 'array'); }; $this->push_vars('', 'service');$this->_foreach['name_service'] = array('total' => count($_from), 'iteration' => 0);
if ($this->_foreach['name_service']['total'] > 0):
    foreach ($_from AS $this->_var['service']):
        $this->_foreach['name_service']['iteration']++;
?>    	<span style="font-weight:bold;" title="<?php echo $this->_var['service']['Description']; ?>"><?php echo $this->_var['service']['ServiceName']; ?></span></br>    	<?php endforeach; endif; unset($_from); ?><?php $this->pop_vars();; ?>    </td>	<td align="center"><?php if ($this->_var['package']['pck_packagestatus']): ?><?php echo $this->_var['lang']['packStorage']; ?><?php else: ?><span style="color:red;"><?php echo $this->_var['lang']['packNoStorage']; ?></span><?php endif; ?></td>    <td align="center" class="order" >      <a href="engrave_package_list.php?act=edit&amp;id=<?php echo $this->_var['package']['pck_id']; ?>" title="<?php echo $this->_var['lang']['edit']; ?>"><?php echo $this->_var['lang']['edit']; ?></a><!-- <img src="images/icon_edit.gif" width="16" height="16" border="0" /> -->      <a href="engrave_package_list.php?act=print&package_id=<?php echo $this->_var['package']['pck_id']; ?><?php if ($this->_var['code'] != 'real_package'): ?>&extension_code=<?php echo $this->_var['code']; ?><?php endif; ?>" target="_blank" title="<?php echo $this->_var['lang']['print']; ?>"><?php echo $this->_var['lang']['print']; ?></a><!-- <img src="images/icon_print.png" width="16" height="16" border="0" /> -->	  <?php if ($this->_var['type'] == 'destroyedlist'): ?>	  <a href="javascript:;" onclick="listTable.remove_return(<?php echo $this->_var['package']['pck_id']; ?>,'<?php echo $this->_var['lang']['drop_return_confirm']; ?>')" title="<?php echo $this->_var['lang']['remove_return']; ?>"><?php echo $this->_var['lang']['remove_return']; ?></a><!-- <img src="images/icon_drop.gif" border="0" height="16" width="16" /> -->	  <?php else: ?>	  <a href="javascript:;" onclick="listTable.remove(<?php echo $this->_var['package']['pck_id']; ?>,'<?php echo $this->_var['lang']['drop_confirm']; ?>')" title="<?php echo $this->_var['lang']['remove']; ?>"><?php echo $this->_var['lang']['remove']; ?></a><!-- <img src="images/icon_drop.gif" border="0" height="16" width="16" /> -->   	  <?php endif; ?>    <a href="javascript:void(0)" onclick="upload_attach('<?php echo $this->_var['package']['pck_id']; ?>')"><?php echo $this->_var['lang']['upload_attach']; ?></a>    </td>  </tr>  <?php endforeach; else: ?>  <tr><td class="no-records" colspan="10"><?php echo $this->_var['lang']['no_records']; ?></td></tr>    <?php endif; unset($_from); ?><?php $this->pop_vars();; ?></table><!-- end package list --><!-- 分页 --><table id="page-table" cellspacing="0">  <tr>    <td align="right" nowrap="true">    <?php echo $this->fetch('page.htm'); ?>    </td>  </tr></table><!-- 批量执行操作 --><table cellspacing="0">  <tr>    <td align="right" class="batch_operate" nowrap="true">    <?php if ($this->_var['type'] == 'expiredlist'): ?>    <a id="batch_print" href="engrave_package_list.php?act=print_outtime" onclick="return confirmFunction('print_outtime');" target="_blank" title="<?php echo $this->_var['lang']['batch_print']; ?>"><?php echo $this->_var['lang']['batch_print_outtime']; ?></a>    <?php endif; ?>    <a id="batch_print" href="engrave_package_list.php?act=print" onclick="return confirmFunction('');" target="_blank" title="<?php echo $this->_var['lang']['batch_print']; ?>"><?php echo $this->_var['lang']['batch_print']; ?></a>    <a id="batch_instorage" href="engrave_package_list.php?act=batch_instorage" onclick="return confirmFunction('instroage');" title="<?php echo $this->_var['lang']['batch_instorage']; ?>"><?php echo $this->_var['lang']['batch_instorage']; ?></a>    <a id="batch_remove" href="engrave_package_list.php?act=batch_remove" onclick="return confirmFunction('remove');" title="<?php echo $this->_var['lang']['batch_delete']; ?>"><?php echo $this->_var['lang']['batch_delete']; ?></a>    </td>  </tr></table><?php if ($this->_var['full_page']): ?></div></form><script type="text/javascript">function confirmFunction(type) {	//获取所选复选框	var inputs = document.getElementsByName("checkboxes[]");	var checked_counts = 0;	var package_id='';	for(var i=0;i<inputs.length;i++){		if(inputs[i].checked){checked_counts++;			package_id = package_id+inputs[i].value+',';}	}	package_id = package_id.substring(0, package_id.length-1);		if(checked_counts > 0)	{		if(type=='instroage')		{			var obj = document.getElementById('batch_instorage');			obj.href="engrave_package_list.php?act=batch_instorage&package_id="+package_id;			if(confirm(instorage_ensure)){return true;}else{return false;}		}else if(type=='remove')		{			var obj = document.getElementById('batch_remove');			obj.href="engrave_package_list.php?act=batch_remove&package_id="+package_id;			if(confirm(remove_ensure)){return true;}else{return false;}		}		else if(type=='print_outtime'){var obj = document.getElementById('batch_print');			obj.href="engrave_package_list.php?act=print_outtime&package_id="+package_id;			return true;}		else{var obj = document.getElementById('batch_print');			obj.href="engrave_package_list.php?act=print&package_id="+package_id;			return true;}	}else{alert(package_id_notnull);		return false;}}/******************************************************************** * 上传附件 *******************************************************************/var index=10;function upload_attach(pck_id){	index=10;   var newMaskID = "mask";  //遮罩层id   var  newMaskWidth =document.body.scrollWidth;//遮罩层宽度   var  newMaskHeight =document.body.scrollHeight;//遮罩层高度       //mask遮罩层    var newMask = document.createElement("div");//创建遮罩层 newMask.id = "shade_mask"+pck_id;//设置遮罩层id newMask.style.position = "absolute";//遮罩层位置 newMask.style.zIndex = "1";//遮罩层zIndex newMask.style.width = newMaskWidth + "px";//设置遮罩层宽度 newMask.style.height = newMaskHeight + "px";//设置遮罩层高度 newMask.style.top = "0px";//设置遮罩层于上边距离 newMask.style.left = "0px";//设置遮罩层左边距离 newMask.style.background = "#B3B3B3";//#33393C//遮罩层背景色 newMask.style.filter = "alpha(opacity=40)";//遮罩层透明度IE newMask.style.opacity = "0.40";//遮罩层透明度FF document.body.appendChild(newMask);//遮罩层添加到DOM中 //新弹出层 var newDivWidth = 400;//新弹出层宽度 var newDivHeight = 300;//新弹出层高度 var newDiv = document.createElement("div");//创建新弹出层 newDiv.style.overflow="auto"; newDiv.id = "shade_div"+pck_id;//设置新弹出层ＩＤ newDiv.style.position = "absolute";//新弹出层位置 newDiv.style.zIndex = "9999";//新弹出层zIndex newDiv.style.width = newDivWidth + "px";//新弹出层宽度 newDiv.style.height = newDivHeight + "px";//新弹出层高度 var newDivtop=(document.body.scrollTop +150) ;//新弹出层距离上边距离 var newDivleft=(document.body.scrollLeft + document.body.clientWidth/2          - newDivWidth/2);//新弹出层距离左边距离 newDiv.style.top = newDivtop+ "px";//新弹出层距离上边距离 newDiv.style.left = newDivleft + "px";//新弹出层距离左边距离 newDiv.style.background = "#FFFFFF";//新弹出层背景色 newDiv.style.border = "1px solid #9DE3F1";///新弹出层边框样式 newDiv.style.padding = "5px";//新弹出层 document.body.appendChild(newDiv);//新弹出层添加到DOM中 var form_file = document.createElement("form"); form_file.action="engrave_package_list.php?act=upload&pck_id="+pck_id; form_file.method="post"; form_file.name="fileForm"; form_file.enctype="multipart/form-data"  newDiv.appendChild(form_file);  //关闭新图层和mask遮罩层 var divClose = document.createElement("div"); divClose.href = "#"; divClose.style.position = "absolute";//span位置 divClose.style.left=newDivWidth -60 + "px"; divClose.style.cursor="pointer"; divClose.style.width="50px"; divClose.innerHTML = "关闭"; divClose.onclick = function()//处理关闭事件 {     if(document.all)     {window.detachEvent("onscroll",newDivCenter);}     else     {window.removeEventListener('scroll',newDivCenter,false);}      document.body.removeChild(newMask);//移除遮罩层         document.body.removeChild(newDiv);////移除弹出框     return false;  } form_file.appendChild(divClose);//添加关闭span //提交表单 var divSubmit = document.createElement("input"); divSubmit.type="submit" divSubmit.style.position = "absolute";//span位置 divSubmit.style.left=newDivWidth/2-10 + "px"; divSubmit.style.bottom=5 + "px"; divSubmit.style.cursor="pointer"; divSubmit.style.width="60px"; divSubmit.name="submit"; divSubmit.value = "提交"; form_file.appendChild(divSubmit);//添加关闭span    var div_File=document.createElement("div");  form_file.appendChild(div_File);  var file1=document.createElement("input");  file1.type="file";  file1.name="file1";  form_file.appendChild(file1);  var index=1;  var newFile=document.createElement("input");  newFile.type="button";  newFile.value="添加上传文件";  newFile.onclick=function()  {	  var file=document.createElement("input");	  file.type="file";	  file.name="file"+(index+1);	  form_file.appendChild(file);	  var removeFile=document.createElement("input");	  removeFile.type="button";	  removeFile.value="移除";	  removeFile.onclick=function()	  {form_file.removeChild(file);		  form_file.removeChild(removeFile);}	  form_file.appendChild(removeFile);  }  div_File.appendChild(newFile);    //弹出层滚动居中 function newDivCenter() {newDiv.style.top = (document.body.scrollTop +150) + "px";    newDiv.style.left = (document.body.scrollLeft + document.body.clientWidth/2             - newDivWidth/2) + "px";} if(document.all)//处理滚动事件，使弹出层始终居中 {window.attachEvent("onscroll",newDivCenter);} else {window.addEventListener('scroll',newDivCenter,false);}}/******************************************************************** * ------上传附件 *******************************************************************/   listTable.recordCount = <?php echo $this->_var['record_count']; ?>;  listTable.pageCount = <?php echo $this->_var['page_count']; ?>;  <?php $_from = $this->_var['filter']; if (!is_array($_from) && !is_object($_from)) { settype($_from, 'array'); }; $this->push_vars('key', 'item');if (count($_from)):
    foreach ($_from AS $this->_var['key'] => $this->_var['item']):
?>  listTable.filter.<?php echo $this->_var['key']; ?> = '<?php echo $this->_var['item']; ?>';  <?php endforeach; endif; unset($_from); ?><?php $this->pop_vars();; ?>    onload = function()  {//document.forms['listForm'].reset();}</script><?php echo $this->fetch('engrave_pagefooter.htm'); ?><?php endif; ?>